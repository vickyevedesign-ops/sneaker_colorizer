<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VickyEve ColourIn's</title>

  <!-- Pickr styles -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/classic.min.css" />

  <style>
    body {
      margin: 0;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      background:#0d0f12;
      color:#eaeef3;
      font-family: sans-serif;
    }
    h1 {
      text-align: center;
      margin: 16px 0;
      font-size: 28px;
      color: #fff;
    }
    main {
      flex: 1;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 24px;
      gap: 32px;
    }
    #stage-wrap {
      position: relative;
      width: min(100%, 900px);
      aspect-ratio: 16 / 9;
      background:#fff; /* White background */
      border:1px solid #222831;
      border-radius:16px;
      padding:24px;
      box-shadow:0 10px 30px rgba(0,0,0,.35);
      overflow:hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #stage-wrap object {
      width: 95%;
      height: 95%;
    }
    aside {
      display:flex;
      flex-direction:column;
      gap:20px;
      padding:20px;
      background:#0f1318;
      border-radius:12px;
      box-shadow:0 6px 20px rgba(0,0,0,.3);
      min-width: 300px;
    }
    .controls button {
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      background: #222831;
      color: #fff;
      cursor: pointer;
      font-size: 14px;
    }
    .controls button:hover {
      background: #444;
    }
  </style>
</head>
<body>
  <h1>VickyEve ColourIn's</h1>
  <main>
    <div id="stage-wrap">
      <object id="sneaker-svg" type="image/svg+xml" data="sneaker1.svg"></object>
    </div>
    <aside>
      <div id="color-picker"></div>
      <div class="controls">
        <button onclick="resetColors()">Undo</button>
        <button onclick="savePNG()">Save</button>
      </div>
    </aside>
  </main>

  <!-- saveSvgAsPng library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/save-svg-as-png/1.4.17/saveSvgAsPng.min.js"></script>

  <!-- Pickr library -->
  <script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr"></script>

  <script>
    const svgObject = document.getElementById("sneaker-svg");
    let currentColor = "#4F46E5"; // default purple

    // Initialize Pickr
    const pickr = Pickr.create({
      el: '#color-picker',
      theme: 'classic', // nice big UI
      default: '#4F46E5',
      swatches: [
        '#F44336', '#E91E63', '#9C27B0', '#673AB7',
        '#3F51B5', '#2196F3', '#03A9F4', '#00BCD4',
        '#009688', '#4CAF50', '#8BC34A', '#CDDC39',
        '#FFEB3B', '#FFC107', '#FF9800', '#FF5722',
        '#795548', '#9E9E9E', '#607D8B'
      ],
      components: {
        preview: true,
        opacity: true,
        hue: true,
        interaction: {
          hex: true,
          rgba: true,
          input: true,
          save: true
        }
      }
    });

    pickr.on('save', (color) => {
      currentColor = color.toHEXA().toString();
      pickr.hide();
    });

    // Load SVG and attach events
    svgObject.addEventListener("load", () => {
      const svgDoc = svgObject.contentDocument;
      const fillables = svgDoc.querySelectorAll(".fillable");
      console.log("Found", fillables.length, "fillable paths");

      fillables.forEach(el => {
        el.style.cursor = "pointer";

        el.addEventListener("mouseenter", () => {
          el.dataset.oldFill = el.getAttribute("fill") || "transparent";
          el.setAttribute("fill", "rgba(200,200,200,0.6)"); // light grey hover
        });

        el.addEventListener("mouseleave", () => {
          el.setAttribute("fill", el.dataset.oldFill);
        });

        el.addEventListener("click", () => {
          el.setAttribute("fill", currentColor);
          el.dataset.oldFill = currentColor; // remember chosen color
        });
      });
    });

    // Reset colors
    function resetColors() {
      const svgDoc = svgObject.contentDocument;
      if (!svgDoc) return;
      svgDoc.querySelectorAll(".fillable").forEach(el => {
        el.removeAttribute("fill");
        el.dataset.oldFill = "transparent";
      });
    }

    // Save as PNG
    function savePNG() {
      const svg = svgObject.contentDocument.querySelector("svg");
      if (!svg) return;
      saveSvgAsPng(svg, "sneaker.png");
    }
  </script>
</body>
</html>
